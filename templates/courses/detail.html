{% extends "base.html" %}
{% load static %}

{% block title %}{{ course.title }} | Build Club{% endblock %}

{% block content %}
  <section class="relative">
    <div class="relative h-[50vh] min-h-[320px] w-full">
      <img
        src="{% static course.image_path %}"
        alt="{{ course.title }}"
        class="h-full w-full object-cover"
      />
      <div class="absolute inset-0 bg-slate-900/55"></div>
      <div class="absolute inset-0 flex items-end">
        <div class="mx-auto w-full max-w-6xl px-6 pb-10 text-white">
          <p class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-200">
            Course Detail
          </p>
          <h1 class="mt-3 text-4xl font-semibold">{{ course.title }}</h1>
          <p class="mt-3 max-w-2xl text-base text-slate-200">
            {{ course.short_description }}
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="mx-auto w-full max-w-6xl px-6 py-16">
    <div class="grid gap-12 lg:grid-cols-[2fr,1fr]">
      <div>
        <div class="rounded-3xl border border-slate-200 bg-white p-8 shadow-sm">
          <h2 class="text-2xl font-semibold text-slate-900">Overview</h2>
          <p class="mt-4 text-base leading-relaxed text-slate-600">
            {{ course.long_description }}
          </p>
        </div>

        <div class="mt-10 rounded-3xl border border-slate-200 bg-white p-8 shadow-sm">
          <h2 class="text-2xl font-semibold text-slate-900">What students will learn</h2>
          <ul class="mt-4 space-y-3 text-base text-slate-600">
            {% for item in course.what_youll_learn_list %}
              <li class="flex items-start gap-3">
                <span class="mt-2 h-2 w-2 rounded-full bg-teal-500"></span>
                <span>{{ item }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>

        {% with profile=course.instructor_profile %}
          {% if profile %}
            <div class="mt-10 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm">
              <div class="border-b border-slate-200 bg-slate-50 px-8 py-6">
                <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">
                  Instructor
                </p>
                {% if profile.name %}
                  <h2 class="mt-3 text-2xl font-semibold text-slate-900">{{ profile.name }}</h2>
                {% endif %}
              </div>
              <div class="grid gap-8 px-8 py-6 md:grid-cols-2">
                <div>
                  {% if profile.role_intro %}
                    <p class="text-sm font-semibold text-slate-700">{{ profile.role_intro }}</p>
                  {% endif %}
                  {% if profile.role_items %}
                    <ul class="mt-4 space-y-3 text-sm text-slate-600">
                      {% for item in profile.role_items %}
                        <li class="flex items-start gap-3">
                          <span class="mt-2 h-2 w-2 rounded-full bg-teal-500"></span>
                          <p>
                            {% for part in item.parts %}
                              {% if part.url %}
                                <a
                                  href="{{ part.url }}"
                                  class="text-teal-600 underline hover:text-teal-500"
                                  target="_blank"
                                  rel="noopener"
                                >
                                  {{ part.text }}
                                </a>
                              {% else %}
                                {{ part.text }}
                              {% endif %}
                            {% endfor %}
                          </p>
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                  {% if profile.role_notes %}
                    <div class="mt-4 space-y-3 text-sm text-slate-600">
                      {% for note in profile.role_notes %}
                        <p>
                          {% for part in note.parts %}
                            {% if part.url %}
                              <a
                                href="{{ part.url }}"
                                class="text-teal-600 underline hover:text-teal-500"
                                target="_blank"
                                rel="noopener"
                              >
                                {{ part.text }}
                              </a>
                            {% else %}
                              {{ part.text }}
                            {% endif %}
                          {% endfor %}
                        </p>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
                <div>
                  <p class="text-sm font-semibold text-slate-700">Credentials</p>
                  {% if profile.credential_items %}
                    <ul class="mt-4 space-y-3 text-sm text-slate-600">
                      {% for item in profile.credential_items %}
                        <li class="flex items-start gap-3">
                          <span class="mt-2 h-2 w-2 rounded-full bg-teal-500"></span>
                          <p>
                            {% for part in item.parts %}
                              {% if part.url %}
                                <a
                                  href="{{ part.url }}"
                                  class="text-teal-600 underline hover:text-teal-500"
                                  target="_blank"
                                  rel="noopener"
                                >
                                  {{ part.text }}
                                </a>
                              {% else %}
                                {{ part.text }}
                              {% endif %}
                            {% endfor %}
                          </p>
                        </li>
                      {% endfor %}
                    </ul>
                  {% else %}
                    <p class="mt-3 text-sm text-slate-500">Details available on request.</p>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endif %}
        {% endwith %}
      </div>

      <aside class="space-y-6">
        <div class="rounded-3xl border border-slate-200 bg-white p-8 shadow-sm">
          <h3 class="text-xl font-semibold text-slate-900">Logistics</h3>
          <dl class="mt-4 space-y-4 text-sm text-slate-600">
            <div>
              <dt class="font-semibold text-slate-800">Location</dt>
              <dd class="mt-1">{{ course.location }}</dd>
            </div>
            <div>
              <dt class="font-semibold text-slate-800">Schedule</dt>
              <dd class="mt-1">
                {{ course.day_of_week }} Â· {{ course.start_time|time:"g:i A" }}
              </dd>
            </div>
            <div>
              <dt class="font-semibold text-slate-800">Session length</dt>
              <dd class="mt-1">{{ course.session_length_minutes }} minutes</dd>
            </div>
            <div>
              <dt class="font-semibold text-slate-800">Capacity</dt>
              <dd class="mt-1">
                {% if course.max_students %}
                  {{ course.max_students }} students
                {% else %}
                  Open capacity
                {% endif %}
              </dd>
            </div>
          </dl>
        </div>

        <div class="rounded-3xl border border-slate-200 bg-white p-8 shadow-sm">
          <h3 class="text-xl font-semibold text-slate-900">Registration</h3>
          <p class="mt-3 text-sm text-slate-600">
            {% if course.is_full %}
              This course is currently full. Please check back for future openings.
            {% else %}
              Weekly lunch-time sessions with short instruction and hands-on building.
            {% endif %}
          </p>
          {% if not course.is_full %}
            <a
              href="{% url 'course_register' course.slug %}"
              class="mt-6 inline-flex w-full items-center justify-center rounded-full bg-teal-500 px-5 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow-lg shadow-teal-500/30 transition hover:bg-teal-400"
            >
              Register now
            </a>
          {% endif %}
        </div>
      </aside>
    </div>
  </section>
{% endblock %}
